# Анализ общественного транспорта и городской мобильности с использованием Python

## Цель задания
Провести полный цикл анализа данных общественного транспорта, используя библиотеки **Python** (Pandas, NumPy, Scikit-learn, Matplotlib/Seaborn, Geopandas) для обработки, анализа и визуализации. Задание фокусируется на оценке эффективности транспортных систем, выявлении паттернов пассажиропотока и оптимизации маршрутов.

## Набор данных
*   **Источники данных**: Используйте датасет **Chicago Transit Authority (CTA) Ridership** на Kaggle.
*   **Потенциальные источники**:
    *   **Основные данные**: CTA Ridership Dataset (https://www.kaggle.com/datasets/chicago/cta-ridership)
    *   **Дополнительные данные**: Chicago Transportation Network Data (маршруты, остановки)
    *   **Дополнительные данные**: Погодные данные Чикаго, календарные события
*   **Структура данных**:
    *   `ridership_data`: Date, Station_ID, Station_Name, Day_Type, Rides, Line_Type (train/bus)
    *   `station_data`: Station_ID, Station_Name, Latitude, Longitude, Line_Color, ADA_Accessible
    *   `weather_data`: Date, Temperature, Precipitation, Snowfall, Weather_Event
    *   `timetable_data`: Route_ID, Stop_ID, Arrival_Time, Departure_Time, Headway
*   **Описание**: Данные содержат информацию о пассажиропотоке на станциях общественного транспорта Чикаго, характеристиках станций, расписании движения и внешних факторах, влияющих на спрос.

## Гипотезы для проверки
1.  Пассажиропоток на станциях общественного транспорта имеет выраженную суточную и недельную сезонность с пиками в часы пик и различиями между рабочими днями и выходными.
2.  Погодные условия (температура, осадки) оказывают статистически значимое влияние на пассажиропоток, причем дождь и снегопад по-разному влияют на разные виды транспорта (метро vs. автобус).
3.  Станции общественного транспорта можно сгруппировать в кластеры на основе паттернов пассажиропотока, причем эти кластеры соответствуют типам районов (деловой центр, жилые районы, транспортные хабы).
4.  Существует положительная корреляция между доступностью станций для маломобильных групп населения (ADA-доступность) и стабильностью пассажиропотока в течение дня.
5.  Пассажиропоток на станциях, обслуживающих несколько линий, демонстрирует меньшую зависимость от внешних факторов (погода, события), чем пассажиропоток на станциях с одной линией.

## Этапы выполнения

### Этап 1. Сбор и подготовка данных (ETL)
**Требования**:
1.  **Загрузка и очистка**:
    *   Загрузите основной датасет о пассажиропотоке и данные о станциях в `DataFrame` с помощью **Pandas**.
    *   Проведите обработку пропусков и аномальных значений (отрицательное количество поездок, несуществующие даты).
    *   Приведите временные данные к единому формату, создайте признаки: час дня, день недели, месяц, сезон.
2.  **Расчет производных показателей**:
    *   Рассчитайте суточные и недельные профили пассажиропотока для каждой станции.
    *   Создайте показатели изменчивости: коэффициент вариации пассажиропотока по дням недели, отношение пикового потока к среднему.
    *   Рассчитайте индикаторы доступности: расстояние до ближайших станций, количество линий на станции.
    *   Добавьте бинарные признаки: выходной день, праздничный день, экстремальные погодные условия.
3.  **Обогащение данных**:
    *   Объедините данные о пассажиропотоке с информацией о станциях и погодными условиями.
    *   Сгруппируйте станции по географическим районам и рассчитайте суммарный пассажиропоток по районам.
    *   Создайте сводные таблицы с наиболее загруженными станциями в разные периоды времени.

### Этап 2. Разведочный анализ и проверка гипотез 1, 2, 4, 5
Для проверки гипотез сформируйте следующие визуализации с помощью **Matplotlib/Seaborn/Geopandas**. К каждому графику приложите краткий вывод.

| № гипотезы | Анализ и визуализация | Метод и библиотеки | Проверяемая гипотеза |
| :--- | :--- | :--- | :--- |
| 1 | Суточная и недельная сезонность | **Линейные графики:** Средний пассажиропоток по часам для рабочих дней и выходных. Отдельные графики для разных типов станций. Seaborn `lineplot`. | Временные паттерны спроса |
| 2 | Влияние погодных условий | **Диаграмма рассеяния с регрессией:** Температура/осадки (X) vs. отклонение пассажиропотока от нормы (Y). Разные цвета для метро и автобусов. Seaborn `lmplot`. | Погодное воздействие на транспорт |
| 4 | Доступность и стабильность потока | **Ящик с усами:** Коэффициент вариации суточного пассажиропотока для станций с ADA-доступностью и без. Seaborn `boxplot`. | Влияние доступности на стабильность |
| 5 | Многолинейность и устойчивость | **Сравнительные гистограммы:** Распределение отклонений пассажиропотока в дождливые дни для станций с разным количеством линий. Matplotlib. | Устойчивость многолинейных станций |

### Этап 3. Кластеризация станций по паттернам пассажиропотока (Гипотеза 3)
**Требования**:
1.  **Подготовка данных для кластеризации**:
    *   Создайте матрицу "станция-временной_интервал" с нормализованными значениями пассажиропотока.
    *   Используйте суточные профили (24 часа) или недельные профили (7 дней) в качестве признаков.
    *   Стандартизируйте данные для устранения влияния абсолютных значений потока.
2.  **Кластеризация**:
    *   Примените алгоритм K-Means и определите оптимальное число кластеров (4-6) с помощью метода локтя и силуэтного анализа.
    *   Для выявления аномальных паттернов примените алгоритм DBSCAN.
    *   Используйте иерархическую кластеризацию для построения дендрограммы и проверки устойчивости кластеров.
3.  **Анализ и визуализация**:
    *   Проанализируйте центры кластеров. Определите характерные паттерны ("Утренний пик/вечерний пик", "Равномерный дневной", "Выходной", "Транспортный хаб").
    *   Визуализируйте результат на географической карте с помощью Geopandas, раскрасив станции по кластерам.
    *   Проанализируйте распределение типов районов, доступности и других характеристик станций внутри кластеров.
    *   Создайте анимированные графики суточных профилей для каждого кластера.

### Этап 4. Создание комплексного аналитического отчета
Создайте структурированный отчет, объединяющий все этапы анализа.
*   Используйте Jupyter Notebook для последовательного выполнения всех шагов.
*   Организуйте отчет:
    *   **Введение и цели анализа**: Исследование пассажиропотока и эффективности системы общественного транспорта.
    *   **Методология**: описание датасетов, методов обработки временных рядов, анализа и кластеризации.
    *   **Результаты**:
        *   Общая характеристика пассажиропотока в транспортной системе.
        *   Визуализация и выводы по гипотезам 1, 2, 4, 5.
        *   Результаты кластеризации станций (гипотеза 3) и характеристика кластеров.
        *   Анализ факторов, влияющих на пассажиропоток.
        *   Практические рекомендации для транспортных операторов.
    *   **Выводы и рекомендации**: Сводка по проверке гипотез, ключевые выводы об эффективности транспортной системы.
*   **Расширенная задача**:
    *   Создайте интерактивную карту с помощью `folium` для визуализации пассажиропотока и кластеров станций.
    *   Реализуйте модель прогнозирования пассажиропотока на основе временных рядов и внешних факторов.
    *   Проведите анализ оптимальности расписания движения на основе данных о пассажиропотоке.
    *   Сгенерируйте PDF-отчет с визуализациями и практическими рекомендациями.

### Этап 5. Заключение
На основе проведенного анализа:
1.  Подведите итоги по каждой проверенной гипотезе (подтверждена, опровергнута, частично подтверждена).
2.  Сформулируйте общие выводы о работе системы общественного транспорта, факторах, влияющих на пассажиропоток, и возможностях оптимизации.
3.  Дайте практические рекомендации:
    *   Для транспортных операторов: как оптимизировать расписание движения в зависимости от типа станций и времени суток, как планировать обслуживание с учетом сезонности и погодных условий.
    *   Для городских планировщиков: как учитывать паттерны пассажиропотока при планировании транспортной инфраструктуры, как улучшать доступность станций.
    *   Для пассажиров: как выбирать оптимальное время для поездок, как использовать информацию о загруженности станций.
    *   Для разработчиков транспортных приложений: как использовать данные о пассажиропотоке для улучшения сервисов навигации и информации в реальном времени.